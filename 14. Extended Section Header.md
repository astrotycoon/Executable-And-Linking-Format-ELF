# Extended Section Header

There are limitations on the number of sections that can be represented by standard ELF data structures.

由于历史的原因，ELF中一些数据的类型不足以表示实际的数量。典型的，section的数量由于现代编程语言的发展有时已经远远超过当初制定ELF标准时的预期。

The `e_shnum` and `e_shstrndx` elements of the ELF header are both limited to being able to represent **65535** sections.

例如***ElfXX_Ehdr***中的`e_shnum`和`e_shstrndx`，它们的类型是***ElfXX_Half***，也就是***unsigned short int***类型，数值上最多可以表示65535个section。

In addition, symbol table entries can reference their associated section using the `st_shndx` element, which is limited to being able to represent **65279** sections. Although the size of this element could represent 65535 sections, a range of values is reserved for special symbol types, **SHN_LORESERVE** (0xff00) - **SHN_HIRESERVE** (0xffff).

另外，每一个符号表表项（symbol table entries）通过数据成员`st_shndx`指定symbol所在的section的节头表索引值，它的类型也是***ElfXX_Half***，不过最多可以指定**65279**个secion。咦？为什么是**65279**，不应该是65535个吗？不要忘了，区间[**SHN_LORESERVE** - **SHN_HIRESERVE**]之间的节表表索引值是保留的，请参阅[Special Section Indexes](https://github.com/astrotycoon/Executable-And-Linking-Format-ELF/blob/main/9.%20Special%20Section%20Indexes.md)。

To allow an ELF object to contain more than **65279** sections, a number of special definitions and a special section type are provided. The resultant ELF object is said to contain extended section header information.

既然类型***ElfXX_Half***最多只能表示**65279**个section，那如果真实情况超过大于**65279**个section该怎么办呢？解决办法是通过一些特殊的定义以及特殊类型的section来解决。通过这样解决方案后的最终ELF文件被称为具有扩展节头信息（extended section header information）。

In a standard ELF object, the first section header is zero filled. See [Figure 4-10: Section Header Table Entry:Index 0](https://github.com/astrotycoon/Executable-And-Linking-Format-ELF/blob/main/11.%20Section%20Types.md#figure-4-10-section-header-table-entryindex-0). When the number of sections exceed the ELF header data sizes, elements of section header 0 are used to define extended ELF header attributes. The following table shows the values.

在section个数未超过**65279**的情况下，第一个节头表表项里的成员数值都是0，请参阅[Figure 4-10: Section Header Table Entry:Index 0](https://github.com/astrotycoon/Executable-And-Linking-Format-ELF/blob/main/11.%20Section%20Types.md#figure-4-10-section-header-table-entryindex-0)。但是在section个数超过**65279**时，第一个节头表表项用来定义扩展的信息，各数据成员的实际含义如下表所示。

### Table 20  ELF Extended Section Header Table Entry: Index 0

**Name** | **Value** | **Note**
|:-|:-|:-|
sh_name|0|No name
sh_type | SHT_NULL |Inactive
sh_flags |0 |No flags
sh_addr|0 |No address
sh_offset|0 |No file offset
sh_size |e_shnum |The number of entries in the section header table
sh_link|e_shstrndx |The section header index of the entry that is associated with the section name string table
sh_info |e_phnum |The number of entries in the program header table
sh_addralign | 0 |No alignment
sh_entsize |0 |No entries


